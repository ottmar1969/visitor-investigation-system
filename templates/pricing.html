<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose Your Plan - Visitor Investigation System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; 
            padding: 20px; 
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 15px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); 
            overflow: hidden; 
        }
        .header { 
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%); 
            color: white; 
            padding: 40px; 
            text-align: center; 
        }
        .header h1 { 
            font-size: 2.5rem; 
            margin-bottom: 10px; 
        }
        .header p { 
            font-size: 1.2rem; 
            opacity: 0.9; 
        }
        .billing-toggle { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            gap: 20px; 
            margin: 30px 0; 
        }
        .toggle-switch { 
            position: relative; 
            width: 60px; 
            height: 30px; 
            background: #e2e8f0; 
            border-radius: 15px; 
            cursor: pointer; 
            transition: all 0.3s; 
        }
        .toggle-switch.active { 
            background: #667eea; 
        }
        .toggle-slider { 
            position: absolute; 
            top: 3px; 
            left: 3px; 
            width: 24px; 
            height: 24px; 
            background: white; 
            border-radius: 50%; 
            transition: all 0.3s; 
        }
        .toggle-switch.active .toggle-slider { 
            transform: translateX(30px); 
        }
        .billing-label { 
            font-weight: 600; 
            color: white; 
        }
        .billing-label.active { 
            color: #ffd700; 
        }
        .savings-badge { 
            background: #48bb78; 
            color: white; 
            padding: 4px 8px; 
            border-radius: 12px; 
            font-size: 0.8rem; 
            font-weight: 600; 
        }
        .plans-container { 
            padding: 40px; 
        }
        .plans-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); 
            gap: 30px; 
            margin-top: 30px; 
        }
        .plan-card { 
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%); 
            border: 2px solid #e2e8f0; 
            border-radius: 15px; 
            padding: 30px; 
            position: relative; 
            transition: all 0.3s; 
        }
        .plan-card:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); 
        }
        .plan-card.popular { 
            border-color: #667eea; 
            transform: scale(1.05); 
        }
        .plan-card.popular::before { 
            content: 'üî• Most Popular'; 
            position: absolute; 
            top: -15px; 
            left: 50%; 
            transform: translateX(-50%); 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 8px 20px; 
            border-radius: 20px; 
            font-size: 0.9rem; 
            font-weight: 600; 
        }
        .plan-name { 
            font-size: 1.5rem; 
            font-weight: bold; 
            color: #2d3748; 
            margin-bottom: 10px; 
        }
        .plan-description { 
            color: #4a5568; 
            margin-bottom: 20px; 
        }
        .plan-price { 
            display: flex; 
            align-items: baseline; 
            gap: 5px; 
            margin-bottom: 20px; 
        }
        .price-amount { 
            font-size: 3rem; 
            font-weight: bold; 
            color: #2d3748; 
        }
        .price-currency { 
            font-size: 1.2rem; 
            color: #4a5568; 
        }
        .price-period { 
            font-size: 1rem; 
            color: #4a5568; 
        }
        .price-savings { 
            background: #c6f6d5; 
            color: #22543d; 
            padding: 4px 8px; 
            border-radius: 8px; 
            font-size: 0.8rem; 
            font-weight: 600; 
            margin-left: 10px; 
        }
        .plan-features { 
            list-style: none; 
            margin-bottom: 30px; 
        }
        .plan-features li { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            padding: 8px 0; 
            color: #4a5568; 
        }
        .plan-features li::before { 
            content: '‚úÖ'; 
            font-size: 1rem; 
        }
        .payment-methods { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 20px; 
            justify-content: center; 
        }
        .payment-btn { 
            flex: 1; 
            padding: 15px 20px; 
            border: 2px solid #e2e8f0; 
            border-radius: 8px; 
            background: white; 
            cursor: pointer; 
            transition: all 0.3s; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 8px; 
            font-weight: 600; 
        }
        .payment-btn:hover { 
            border-color: #667eea; 
            background: #f7fafc; 
        }
        .payment-btn.stripe { 
            color: #635bff; 
        }
        .payment-btn.paypal { 
            color: #0070ba; 
        }
        .trial-info { 
            background: #bee3f8; 
            color: #2c5282; 
            padding: 15px; 
            border-radius: 8px; 
            text-align: center; 
            font-size: 0.9rem; 
            margin-bottom: 20px; 
        }
        .guarantee { 
            text-align: center; 
            color: #4a5568; 
            font-size: 0.9rem; 
            margin-top: 30px; 
        }
        @media (max-width: 768px) { 
            .plans-grid { 
                grid-template-columns: 1fr; 
            }
            .plan-card.popular { 
                transform: none; 
            }
            .payment-methods { 
                flex-direction: column; 
            }
        }
    </style>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&vault=true&intent=subscription"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí≥ Choose Your Plan</h1>
            <p>Start tracking visitors and growing your business today</p>
            
            <div class="billing-toggle">
                <span class="billing-label" id="monthlyLabel">Monthly</span>
                <div class="toggle-switch" id="billingToggle" onclick="toggleBilling()">
                    <div class="toggle-slider"></div>
                </div>
                <span class="billing-label" id="yearlyLabel">Yearly</span>
                <span class="savings-badge">Save 17%</span>
            </div>
        </div>
        
        <div class="plans-container">
            <div class="plans-grid">
                <!-- Basic Plan -->
                <div class="plan-card">
                    <div class="plan-name">Basic Plan</div>
                    <div class="plan-description">Perfect for small businesses</div>
                    
                    <div class="plan-price">
                        <span class="price-currency">$</span>
                        <span class="price-amount" id="basic-price">29.99</span>
                        <span class="price-period" id="basic-period">/month</span>
                        <span class="price-savings" id="basic-savings" style="display: none;">Save $60/year</span>
                    </div>
                    
                    <ul class="plan-features">
                        <li>Up to 5 users</li>
                        <li>1 website tracking</li>
                        <li>Basic visitor analytics</li>
                        <li>Email support</li>
                        <li>CSV export</li>
                        <li>50 visitors per page</li>
                        <li>Real-time tracking</li>
                    </ul>
                    
                    <div class="trial-info">
                        üéØ Start with a 7-day free trial
                    </div>
                    
                    <div class="payment-methods">
                        <button class="payment-btn stripe" onclick="selectPayment('basic', 'stripe')">
                            üí≥ Pay with Stripe
                        </button>
                        <button class="payment-btn paypal" onclick="selectPayment('basic', 'paypal')">
                            üÖøÔ∏è Pay with PayPal
                        </button>
                    </div>
                </div>
                
                <!-- Professional Plan -->
                <div class="plan-card popular">
                    <div class="plan-name">Professional Plan</div>
                    <div class="plan-description">For growing businesses</div>
                    
                    <div class="plan-price">
                        <span class="price-currency">$</span>
                        <span class="price-amount" id="pro-price">79.99</span>
                        <span class="price-period" id="pro-period">/month</span>
                        <span class="price-savings" id="pro-savings" style="display: none;">Save $160/year</span>
                    </div>
                    
                    <ul class="plan-features">
                        <li>Up to 15 users</li>
                        <li>5 websites tracking</li>
                        <li>Advanced analytics</li>
                        <li>Priority support</li>
                        <li>Excel & CSV export</li>
                        <li>API access</li>
                        <li>Custom reports</li>
                        <li>Country restrictions</li>
                        <li>User permissions</li>
                    </ul>
                    
                    <div class="trial-info">
                        üöÄ Start with a 14-day free trial
                    </div>
                    
                    <div class="payment-methods">
                        <button class="payment-btn stripe" onclick="selectPayment('professional', 'stripe')">
                            üí≥ Pay with Stripe
                        </button>
                        <button class="payment-btn paypal" onclick="selectPayment('professional', 'paypal')">
                            üÖøÔ∏è Pay with PayPal
                        </button>
                    </div>
                </div>
                
                <!-- Enterprise Plan -->
                <div class="plan-card">
                    <div class="plan-name">Enterprise Plan</div>
                    <div class="plan-description">For large organizations</div>
                    
                    <div class="plan-price">
                        <span class="price-currency">$</span>
                        <span class="price-amount" id="enterprise-price">199.99</span>
                        <span class="price-period" id="enterprise-period">/month</span>
                        <span class="price-savings" id="enterprise-savings" style="display: none;">Save $400/year</span>
                    </div>
                    
                    <ul class="plan-features">
                        <li>Up to 50 users</li>
                        <li>25 websites tracking</li>
                        <li>Enterprise analytics</li>
                        <li>Dedicated support</li>
                        <li>All export formats</li>
                        <li>Full API access</li>
                        <li>Custom integrations</li>
                        <li>White-label options</li>
                        <li>Advanced security</li>
                        <li>Custom training</li>
                    </ul>
                    
                    <div class="trial-info">
                        üèÜ Start with a 30-day free trial
                    </div>
                    
                    <div class="payment-methods">
                        <button class="payment-btn stripe" onclick="selectPayment('enterprise', 'stripe')">
                            üí≥ Pay with Stripe
                        </button>
                        <button class="payment-btn paypal" onclick="selectPayment('enterprise', 'paypal')">
                            üÖøÔ∏è Pay with PayPal
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="guarantee">
                üõ°Ô∏è 30-day money-back guarantee ‚Ä¢ üîí Secure payments ‚Ä¢ üìû 24/7 support
            </div>
        </div>
    </div>

    <script>
        let isYearly = false;
        
        const plans = {
            basic: { monthly: 29.99, yearly: 24.99 },
            professional: { monthly: 79.99, yearly: 66.66 },
            enterprise: { monthly: 199.99, yearly: 166.66 }
        };

        function toggleBilling() {
            isYearly = !isYearly;
            const toggle = document.getElementById('billingToggle');
            const monthlyLabel = document.getElementById('monthlyLabel');
            const yearlyLabel = document.getElementById('yearlyLabel');
            
            toggle.classList.toggle('active');
            
            if (isYearly) {
                monthlyLabel.classList.remove('active');
                yearlyLabel.classList.add('active');
            } else {
                monthlyLabel.classList.add('active');
                yearlyLabel.classList.remove('active');
            }
            
            updatePricing();
        }

        function updatePricing() {
            Object.keys(plans).forEach(plan => {
                const price = isYearly ? plans[plan].yearly : plans[plan].monthly;
                const period = isYearly ? '/month (billed yearly)' : '/month';
                
                document.getElementById(`${plan}-price`).textContent = price.toFixed(2);
                document.getElementById(`${plan}-period`).textContent = period;
                
                const savings = document.getElementById(`${plan}-savings`);
                if (isYearly) {
                    const monthlyCost = plans[plan].monthly * 12;
                    const yearlyCost = plans[plan].yearly * 12;
                    const savedAmount = Math.round(monthlyCost - yearlyCost);
                    savings.textContent = `Save $${savedAmount}/year`;
                    savings.style.display = 'inline-block';
                } else {
                    savings.style.display = 'none';
                }
            });
        }

        function selectPayment(planId, provider) {
            const billingCycle = isYearly ? 'yearly' : 'monthly';
            
            if (provider === 'stripe') {
                initiateStripePayment(planId, billingCycle);
            } else if (provider === 'paypal') {
                initiatePayPalPayment(planId, billingCycle);
            }
        }

        async function initiateStripePayment(planId, billingCycle) {
            try {
                // Show loading state
                const button = event.target;
                const originalText = button.innerHTML;
                button.innerHTML = '‚è≥ Processing...';
                button.disabled = true;
                
                // Create subscription on backend
                const response = await fetch('/api/create-stripe-subscription', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        plan_id: planId,
                        billing_cycle: billingCycle,
                        client_id: 'demo_client_id' // Replace with actual client ID
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Initialize Stripe
                    const stripe = Stripe('pk_test_your_stripe_publishable_key'); // Replace with your publishable key
                    
                    // Confirm payment
                    const { error } = await stripe.confirmCardPayment(result.client_secret);
                    
                    if (error) {
                        alert('Payment failed: ' + error.message);
                    } else {
                        alert('Payment successful! Welcome to your new plan!');
                        window.location.href = '/dashboard';
                    }
                } else {
                    alert('Error: ' + result.error);
                }
                
                // Restore button
                button.innerHTML = originalText;
                button.disabled = false;
                
            } catch (error) {
                console.error('Payment error:', error);
                alert('Payment failed. Please try again.');
                
                // Restore button
                const button = event.target;
                button.innerHTML = 'üí≥ Pay with Stripe';
                button.disabled = false;
            }
        }

        async function initiatePayPalPayment(planId, billingCycle) {
            try {
                // Show loading state
                const button = event.target;
                const originalText = button.innerHTML;
                button.innerHTML = '‚è≥ Processing...';
                button.disabled = true;
                
                // Create subscription on backend
                const response = await fetch('/api/create-paypal-subscription', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        plan_id: planId,
                        billing_cycle: billingCycle,
                        client_id: 'demo_client_id', // Replace with actual client ID
                        return_url: window.location.origin + '/payment/paypal/success',
                        cancel_url: window.location.origin + '/payment/paypal/cancel'
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Redirect to PayPal approval URL
                    window.location.href = result.approval_url;
                } else {
                    alert('Error: ' + result.error);
                    
                    // Restore button
                    button.innerHTML = originalText;
                    button.disabled = false;
                }
                
            } catch (error) {
                console.error('Payment error:', error);
                alert('Payment failed. Please try again.');
                
                // Restore button
                const button = event.target;
                button.innerHTML = 'üÖøÔ∏è Pay with PayPal';
                button.disabled = false;
            }
        }

        // Initialize with monthly pricing
        updatePricing();
    </script>
</body>
</html>

